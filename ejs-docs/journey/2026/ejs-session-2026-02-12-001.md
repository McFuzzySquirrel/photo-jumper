session_id: ejs-session-2026-02-12-001
author: copilot
date: 2026-02-12
repo: McFuzzySquirrel/photo-jumper
branch: copilot/refactor-android-ui
agents_involved: [copilot-coding-agent]
decision_detected: true
adr_links: [docs/adr/0010-android-game-app-packaging-with-capacitor.md]
tags: [android, capacitor, mobile-ux, game-app, planning, research]
refs: [docs/prd/android-game-app-plan.md, docs/adr/0006-cross-platform-packaging-strategy.md]

# Problem / Intent

Create a comprehensive plan for converting Photo Jumper's ML-only version into an Android game app. The app should be installable on Android devices with the eventual goal of Play Store distribution. Key focus areas:
1. Research the best packaging approach for an Android game app
2. Audit the current UI for Android game readiness gaps
3. Design a more intuitive, touch-first mobile game UX
4. Create a phased refactoring plan

The user explicitly clarified this is a **game app**, not a generic utility app, which means game-specific UX patterns (thumb-zone controls, immersive fullscreen, haptic feedback, streamlined game flow) are critical.

# Interaction Summary (Required)

- Human: Request to create planning branch and research/plan Android app conversion
  - Agent: Explored full repository structure, all JS modules, HTML UI, existing ADRs (especially ADR 0006 on cross-platform packaging), PRD docs, config, and touch controls
  - Outcome: Complete understanding of current architecture, detection pipeline, UI flow, and mobile control state

- Human: Clarified "app" means "game app" (not utility app)
  - Agent: Adjusted research focus to mobile game UX patterns — touch platformer controls, game flow optimization, haptic feedback, immersive mode, game-specific onboarding
  - Outcome: Research reframed around mobile gaming best practices (Super Mario Run, Geometry Dash patterns)

- Agent: Conducted research on packaging approaches
  - Compared Capacitor, TWA, custom WebView, and full native rewrite
  - Analyzed against decision drivers: game UX, native APIs, code reuse, Play Store, offline ML, effort
  - Outcome: Capacitor recommended as best balance of native access and code reuse

- Agent: Audited current UI for Android game readiness
  - Identified 16+ gaps across critical, moderate, and nice-to-have categories
  - Key findings: touch controls too small (27.5px = ~14dp, should be 64-80dp), too many setup steps, ML mode hidden, no haptics, no pause menu, desktop-oriented instructions
  - Outcome: Comprehensive gap analysis documented in PRD

- Agent: Created phased refactoring plan
  - Phase 0: Capacitor setup (1-2 days)
  - Phase 1: UI refactoring for game UX (3-5 days)
  - Phase 2: Native integration & polish (2-3 days)
  - Phase 3: Store preparation (2-3 days)
  - Outcome: Detailed PRD and ADR created

# Agent Collaboration Summary

**Key prompts used:**
- Explored entire repository structure systematically (directory tree, all JS modules, HTML, CSS, config, ADRs)
- Searched for touch/mobile/fullscreen patterns across codebase
- Reviewed existing ADR 0006 for prior cross-platform analysis

**Key suggestions:**
- Capacitor over TWA for native API access (camera, haptics, orientation lock)
- Fixed thumb zone controls with 64-80dp sizing (Android Material Design guidelines)
- Simplified game flow: Splash → Menu → Photo → Play (reduced from 5+ steps)
- ML-only as default mode (remove user-facing toggles)
- Haptic feedback on jump, collect, and win events

**Corrections required:**
- User corrected "app" to "game app" — adjusted entire research focus

# Agent Influence (Required)

- **Suggestions adopted:**
  - Capacitor as packaging framework (based on native API needs analysis)
  - Touch control sizing based on Android Material Design minimums (48dp) and game UX research (64-80dp)
  - Game flow simplification inspired by mobile platformer patterns
  - Phased implementation approach with clear milestones

- **Suggestions rejected (and why):**
  - None rejected in this planning session

- **Human overrides / corrections:**
  - "App" clarified as "game app" — shifted focus from generic mobile app UX to game-specific patterns

# Experiments / Evidence

- **Codebase audit**: Current touch controls are 27.5px (approximately 14dp on a 2x display), well below the 48dp Android minimum and 64-80dp game recommendation
- **Flow analysis**: Current path to gameplay requires 5+ interactions (Splash → Intro → Game Screen → Upload → Fullscreen → Play), reduced to 3 in proposed design
- **Architecture review**: Confirmed that Canvas rendering, ONNX pipeline, and physics engine are all compatible with Capacitor WebView — no rewrite needed

# Iteration Log

1. Started with broad "Android app" research scope
2. Narrowed to "Android game app" after user clarification — this shifted control layout research from generic mobile patterns to platformer-specific thumb zones
3. Compared 4 packaging options systematically before recommending Capacitor
4. Audited 20+ UI elements against mobile game standards, categorized by priority

# Decisions Made

- **Decision**: Use Capacitor for Android game app packaging
  - Reason: Best combination of native API access (camera, haptics, orientation), code reuse (existing web game runs as-is), and Play Store readiness
  - Impact: Requires Android Studio, adds ~5-10MB to APK, but enables native game feel

- **Decision**: ML-only mode as default for Android
  - Reason: Simplifies UX (no toggle confusion), ML is the differentiating feature, fallback chain handles sparse photos
  - Impact: Debug/grid toggles move to hidden developer settings

- **Decision**: Fixed thumb zone control layout (not virtual joystick)
  - Reason: Matches existing ◀ ▲ ▶ pattern, simpler than floating joystick, proven in casual platformers
  - Impact: Touch controls grow from 27.5px to 64-80dp, repositioned to thumb zones

# Key Learnings

**Technical insights:**
- Current touch controls at 27.5px are roughly 14dp on a 2x display — less than one-third of Android's recommended 48dp minimum
- The game already has orientation lock code but it only works with the Fullscreen API; Capacitor's native plugin is more reliable
- ONNX model is only ~6MB, so bundling in APK is feasible without excessive size impact
- Canvas 2D performance in Android WebView is hardware-accelerated and sufficient for this game's complexity

**Prompting insights:**
- Clarifying "game app" vs "app" fundamentally changed the UX research direction
- Game-specific UX patterns differ significantly from generic mobile app patterns

**Tooling insights:**
- Capacitor's no-build-step philosophy aligns well with Photo Jumper's architecture (ES modules, no bundler)
- Capacitor plugins handle the exact native features this game needs (camera, haptics, orientation)

# If Repeating This Work

**Do this:**
- Start by auditing current touch controls against platform-specific design guidelines (48dp Android, 44pt iOS)
- Review existing ADRs early — ADR 0006 already laid groundwork for this decision
- Categorize UI gaps by severity (critical/moderate/nice-to-have) to focus implementation phases

**Avoid this:**
- Don't assume "mobile app" means the same as "mobile game app" — game UX has distinct patterns
- Don't evaluate packaging options without listing specific native API requirements first

**Watch out for:**
- WebView WASM performance varies significantly across Android versions and chipsets
- Android back button behavior needs explicit handling in game context (pause, not exit)
- Safe area insets for notches and camera cutouts affect HUD placement

# Future Agent Guidance

**Prefer:**
- Capacitor plugin calls over raw WebView JavaScript bridges
- Game-specific control sizing (64-80dp) over Material Design minimums (48dp)
- Progressive enhancement: features work in web PWA, enhanced in native app
- Phased implementation with testable milestones

**Avoid:**
- Adding build tooling (webpack/vite) unless explicitly requested
- Modifying player physics or game mechanics during the packaging refactor
- Creating separate codebases for web and Android
- Using deprecated Android APIs (target Android 8.0+ / API 26+)

## MACHINE EXTRACTS

### INTERACTION_EXTRACT
- session: ejs-session-2026-02-12-001
- intent: Plan Android game app conversion for Photo Jumper ML-only edition
- key_interactions:
  - explored_repo_structure: complete (all JS modules, HTML, CSS, ADRs, PRDs)
  - clarification: "app" means "game app" — game-specific UX required
  - packaging_research: compared Capacitor, TWA, WebView wrapper, native rewrite
  - ui_audit: 20+ gaps identified, categorized by priority
  - plan_created: 4-phase implementation with 10-16 day timeline

### DECISIONS_EXTRACT
- decisions:
  - packaging: Capacitor (native API access, code reuse, Play Store ready)
  - default_mode: ML-only (simplify UX, remove toggles)
  - controls: Fixed thumb zone (64-80dp, D-pad left + jump right)
  - adr_created: docs/adr/0010-android-game-app-packaging-with-capacitor.md

### LEARNING_EXTRACT
- learnings:
  - current_touch_controls: 27.5px ≈ 14dp (below 48dp Android minimum)
  - onnx_model_size: ~6MB (feasible for APK bundling)
  - game_flow_steps: current 5+ → proposed 3
  - webview_canvas: hardware-accelerated, sufficient for 2D platformer

### AGENT_GUIDANCE_EXTRACT
- guidance:
  - use_capacitor_plugins: camera, haptics, screen-orientation, status-bar, splash-screen, app
  - control_sizing: 64-80dp for game buttons
  - ml_only_default: true (remove user-facing toggles)
  - no_build_tooling: maintain ES module + no-bundler architecture
  - android_min_sdk: 26 (Android 8.0)
